# üöÄ –ü–û–õ–ù–û–ï –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò –î–ï–ü–õ–û–Ø

## –í–´ –ü–û–õ–£–ß–ò–¢–ï:
‚úÖ –û–¥–∏–Ω setup —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Docker, PostgreSQL, Node.js, Python)  
‚úÖ GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–∏ –ø—É—à–µ –≤ GitHub  
‚úÖ Nginx –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –¥–æ–º–µ–Ω–∞ –∫ –≤–∞—à–µ–º—É —Å–∞–π—Ç—É  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ —Å–∞–π—Ç–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–¥–∞  
‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt) –¥–ª—è HTTPS  

---

## –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å:

1. **Ubuntu —Å–µ—Ä–≤–µ—Ä** (20.04 –∏–ª–∏ –≤—ã—à–µ)
   - –ú–∏–Ω–∏–º—É–º 1GB RAM
   - –ú–∏–Ω–∏–º—É–º 10GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
   - Root –¥–æ—Å—Ç—É–ø –∏–ª–∏ sudo –ø—Ä–∞–≤–∞

2. **–î–æ–º–µ–Ω** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - –ö—É–ø–ª–µ–Ω–Ω—ã–π –Ω–∞ Reg.ru, Namecheap, GoDaddy –∏ —Ç.–¥.
   - DNS –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞

3. **GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   - –í–∞—à –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ GitHub
   - –î–æ—Å—Ç—É–ø –¥–ª—è push/pull

---

## –≠–¢–ê–ü 1: –ü–û–î–ì–û–¢–û–í–ö–ê –°–ï–†–í–ï–†–ê

### –®–ê–ì 1Ô∏è‚É£ - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@your-server-ip
# –∏–ª–∏
ssh your-username@your-server-ip
```

### –®–ê–ì 2Ô∏è‚É£ - –°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ setup —Å–∫—Ä–∏–ø—Ç

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ï—Å–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ –Ω–∞ GitHub**

```bash
# –°–∫–∞—á–∏–≤–∞–µ–º —Å–∫—Ä–∏–ø—Ç –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
curl -fsSL https://raw.githubusercontent.com/–í–ê–®-–ù–ò–ö/–í–ê–®-–†–ï–ü–û/main/deploy/setup.sh -o setup.sh

# –î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x setup.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º
./setup.sh
```

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –ö–ª–æ–Ω–∏—Ä—É–µ–º –≤–µ—Å—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/–í–ê–®-–ù–ò–ö/–í–ê–®-–†–ï–ü–û.git keystone_project
cd keystone_project

# –î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x deploy/setup.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º
./deploy/setup.sh
```

### –®–ê–ì 3Ô∏è‚É£ - –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ß—Ç–æ —Å–¥–µ–ª–∞–µ—Ç setup.sh:**
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç —Å–∏—Å—Ç–µ–º—É Ubuntu
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Docker –∏ Docker Compose
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Node.js 18
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Python 3.11
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Nginx
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Certbot –¥–ª—è SSL
- ‚úÖ –ö–ª–æ–Ω–∏—Ä—É–µ—Ç –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω)
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç .env —Ñ–∞–π–ª –∏–∑ .env.example
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –¥–æ–º–µ–Ω –∏ –ø–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–æ–º–µ–Ω)
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –®–ê–ì 4Ô∏è‚É£ - –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª

```bash
nano ~/keystone_project/.env
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ:**
- `DB_PASSWORD` ‚Üí –ù–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è PostgreSQL
- `TELEGRAM_BOT_TOKEN` ‚Üí –¢–æ–∫–µ–Ω –æ—Ç BotFather
- `BOT_TOKEN` ‚Üí –¢–æ—Ç –∂–µ —Ç–æ–∫–µ–Ω –æ—Ç BotFather
- `ADMIN_ID` ‚Üí –í–∞—à Telegram ID
- `ADMIN_IDS` ‚Üí –í–∞—à Telegram ID (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- `JWT_SECRET` ‚Üí –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è JWT (–Ω–∞–ø—Ä–∏–º–µ—Ä: `openssl rand -base64 32`)

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:**
- `DOMAIN` ‚Üí –í–∞—à –¥–æ–º–µ–Ω
- `SSL_EMAIL` ‚Üí Email –¥–ª—è Let's Encrypt

–ù–∞–∂–º–∏—Ç–µ `Ctrl+X`, –∑–∞—Ç–µ–º `Y`, –ø–æ—Ç–æ–º `Enter` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

### –®–ê–ì 5Ô∏è‚É£ - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```bash
cd ~/keystone_project
docker-compose down
docker-compose up -d --build
```

### –®–ê–ì 6Ô∏è‚É£ - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å

```bash
docker-compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Å—Ç–∞—Ç—É—Å–µ **Up**:
- ‚úÖ keystone_postgres - Up
- ‚úÖ keystone_backend - Up
- ‚úÖ keystone_bot - Up

### –®–ê–ì 7Ô∏è‚É£ - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
# –í—Å–µ –ª–æ–≥–∏
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –±–æ—Ç
docker-compose logs -f bot

# –¢–æ–ª—å–∫–æ backend
docker-compose logs -f backend

# –¢–æ–ª—å–∫–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
docker-compose logs -f postgres
```

---

## –≠–¢–ê–ü 2: –ù–ê–°–¢–†–û–ô–ö–ê –î–û–ú–ï–ù–ê (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

### –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–º–µ–Ω

**–ù–∞ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º (Reg.ru, Namecheap, GoDaddy –∏ —Ç.–¥.):**

1. –ù–∞–π–¥–∏—Ç–µ **DNS records** –∏–ª–∏ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS**
2. –î–æ–±–∞–≤—å—Ç–µ/–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ **A record**:
   - **–ò–º—è (Name):** @ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º
   - **–¢–∏–ø (Type):** A
   - **–ó–Ω–∞—á–µ–Ω–∏–µ (Value):** IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - **TTL:** 3600 (–∏–ª–∏ default)

3. –î–æ–±–∞–≤—å—Ç–µ **CNAME record** –¥–ª—è www:
   - **–ò–º—è (Name):** www
   - **–¢–∏–ø (Type):** CNAME
   - **–ó–Ω–∞—á–µ–Ω–∏–µ (Value):** –≤–∞—à-–¥–æ–º–µ–Ω.com
   - **TTL:** 3600 (–∏–ª–∏ default)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ DNS (–ø–æ–¥–æ–∂–¥–∏—Ç–µ 5-30 –º–∏–Ω—É—Ç):**

```bash
nslookup –≤–∞—à-–¥–æ–º–µ–Ω.com
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```

### –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç setup.sh –±—ã–ª –∑–∞–ø—É—â–µ–Ω –ë–ï–ó –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL

**–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL –≤—Ä—É—á–Ω—É—é:**

```bash
# –£–∫–∞–∂–∏—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω
DOMAIN="–≤–∞—à-–¥–æ–º–µ–Ω.com"
EMAIL="–≤–∞—à-email@example.com"

# –ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot --nginx -d $DOMAIN -d www.$DOMAIN -m $EMAIL --agree-tos --no-eff-email

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
sudo systemctl reload nginx
```

---

## –≠–¢–ê–ü 3: –ù–ê–°–¢–†–û–ô–ö–ê GITHUB ACTIONS

### –®–ê–ì 1Ô∏è‚É£ - –°–æ–∑–¥–∞–π—Ç–µ SSH –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—è

**–ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**

```bash
# –°–æ–∑–¥–∞–µ–º SSH –∫–ª—é—á
ssh-keygen -t rsa -b 4096 -f ~/.ssh/deploy_key -N ""

# –ö–æ–ø–∏—Ä—É–µ–º PUBLIC –∫–ª—é—á
cat ~/.ssh/deploy_key.pub
```

### –®–ê–ì 2Ô∏è‚É£ - –î–æ–±–∞–≤—å—Ç–µ PUBLIC –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
# –û—Ç–∫—Ä—ã–≤–∞–µ–º authorized_keys
nano ~/.ssh/authorized_keys

# –í—Å—Ç–∞–≤–ª—è–µ–º –≤–∞—à PUBLIC –∫–ª—é—á (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞)
# –°–æ—Ö—Ä–∞–Ω—è–µ–º: Ctrl+X, Y, Enter

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

### –®–ê–ì 3Ô∏è‚É£ - –î–æ–±–∞–≤—å—Ç–µ PRIVATE –∫–ª—é—á –≤ GitHub Secrets

**–ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**

```bash
# –ö–æ–ø–∏—Ä—É–µ–º PRIVATE –∫–ª—é—á
cat ~/.ssh/deploy_key
```

**–í GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Secrets and variables ‚Üí Actions**
2. –ù–∞–∂–º–∏—Ç–µ **New repository secret**
3. –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

| –ò–º—è | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-----|----------|
| `SERVER_IP` | IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 123.45.67.89) |
| `SERVER_USER` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: root –∏–ª–∏ ubuntu) |
| `SERVER_SSH_KEY` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ ~/.ssh/deploy_key (–í–ï–°–¨ —Ç–µ–∫—Å—Ç) |
| `SERVER_PORT` | –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å) |

### –®–ê–ì 4Ô∏è‚É£ - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ workflow —Ñ–∞–π–ª

–§–∞–π–ª `.github/workflows/deploy.yml` —É–∂–µ —Å–æ–∑–¥–∞–Ω –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```bash
cat .github/workflows/deploy.yml
```

---

## –≠–¢–ê–ü 4: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ì–û –î–ï–ü–õ–û–Ø

### –®–ê–ì 1Ô∏è‚É£ - –°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–º–∏—Ç

```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
cd /–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–ø—Ä–æ–µ–∫—Ç—É

# –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ README)
echo "# Test deploy" >> README.md

# –ö–æ–º–º–∏—Ç –∏ –ø—É—à
git add .
git commit -m "Test: automatic deploy"
git push origin main
```

### –®–ê–ì 2Ô∏è‚É£ - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Actions**
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–π workflow "üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä"

### –®–ê–ì 3Ô∏è‚É£ - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
cd ~/keystone_project
docker-compose logs -f
```

---

## –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

### Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd ~/keystone_project

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose logs -f

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose logs -f backend
docker-compose logs -f bot
docker-compose logs -f postgres

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose restart backend

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d --build

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ (–í–ù–ò–ú–ê–ù–ò–ï: —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ!)
docker-compose down -v

# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–∑—ã
docker image prune -a

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
docker system df
```

### Nginx –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
sudo systemctl reload nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
sudo systemctl restart nginx

# –°—Ç–∞—Ç—É—Å Nginx
sudo systemctl status nginx

# –õ–æ–≥–∏ Nginx
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log
```

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
sudo certbot certificates

# –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é
sudo certbot renew

# –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (dry run)
sudo certbot renew --dry-run
```

### Git –∫–æ–º–∞–Ω–¥—ã

```bash
# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏–∑ GitHub
cd ~/keystone_project
git pull origin main

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É
git branch

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å
git status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã
git log --oneline -10
```

### –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
cd ~/keystone_project
./deploy/quick-update.sh
```

---

## –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í –ü–†–û–ï–ö–¢–ê

```
keystone_project/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml          # GitHub Actions workflow
‚îú‚îÄ‚îÄ deploy/
‚îÇ   ‚îú‚îÄ‚îÄ setup.sh               # –ì–ª–∞–≤–Ω—ã–π setup —Å–∫—Ä–∏–ø—Ç
‚îÇ   ‚îî‚îÄ‚îÄ quick-update.sh        # –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ telegram_bot/              # –ö–æ–¥ Telegram –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config/                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è backend
‚îú‚îÄ‚îÄ controllers/               # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã backend
‚îú‚îÄ‚îÄ routes/                    # –ú–∞—Ä—à—Ä—É—Ç—ã backend
‚îú‚îÄ‚îÄ services/                  # –°–µ—Ä–≤–∏—Å—ã backend
‚îú‚îÄ‚îÄ middleware/                # Middleware backend
‚îú‚îÄ‚îÄ sql/                       # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .env.example               # –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ .env                       # –í–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile.backend         # Dockerfile –¥–ª—è backend
‚îú‚îÄ‚îÄ Dockerfile.bot             # Dockerfile –¥–ª—è –±–æ—Ç–∞
‚îú‚îÄ‚îÄ server.cjs                 # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª backend
‚îú‚îÄ‚îÄ run_bot.py                 # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îî‚îÄ‚îÄ package.json               # NPM –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

---

## –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ backend

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl http://localhost:3000/api/users

# –° –¥–æ–º–µ–Ω–∞
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.com/api/users
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞

–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –≤–∞—à–µ–º—É –±–æ—Ç—É –≤ Telegram - –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å!

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
docker-compose exec postgres psql -U postgres -d keystone

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã
\dt

# –í—ã–π—Ç–∏
\q
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect –≤–∞—à-–¥–æ–º–µ–Ω.com:443 -servername –≤–∞—à-–¥–æ–º–µ–Ω.com

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
https://–≤–∞—à-–¥–æ–º–µ–Ω.com
```

---

## –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä_–∏–º—è

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d --build --force-recreate –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä_–∏–º—è
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
docker-compose ps postgres

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL
docker-compose logs postgres

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
docker-compose exec postgres psql -U postgres -d keystone
```

### –ü—Ä–æ–±–ª–µ–º–∞: GitHub Actions –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ GitHub
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ SSH –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –≤—Ä—É—á–Ω—É—é —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º

### –ü—Ä–æ–±–ª–µ–º–∞: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
nslookup –≤–∞—à-–¥–æ–º–µ–Ω.com

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç
sudo ufw status

# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—Ä—É—á–Ω—É—é
sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.com
```

### –ü—Ä–æ–±–ª–µ–º–∞: Nginx –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 502 Bad Gateway

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
docker-compose ps backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend
docker-compose logs backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend
docker-compose restart backend
```

---

## –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ .env**
   - DB_PASSWORD - —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
   - JWT_SECRET - —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall**
   ```bash
   sudo ufw allow 22/tcp    # SSH
   sudo ufw allow 80/tcp    # HTTP
   sudo ufw allow 443/tcp   # HTTPS
   sudo ufw enable
   ```

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É**
   ```bash
   sudo apt update
   sudo apt upgrade -y
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
   ```bash
   # –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç backup.sh
   docker-compose exec -T postgres pg_dump -U postgres keystone > backup_$(date +%Y%m%d).sql
   
   # –î–æ–±–∞–≤—å—Ç–µ –≤ cron –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
   crontab -e
   # –î–æ–±–∞–≤—å—Ç–µ: 0 2 * * * /home/user/keystone_project/backup.sh
   ```

---

## –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
docker stats

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å
free -h

# –ü—Ä–æ—Ü–µ—Å—Å—ã
htop

# –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
journalctl -xe
```

---

## –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö-–õ–ò–°–¢

**–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:**
- [ ] –°–µ—Ä–≤–µ—Ä Ubuntu –≥–æ—Ç–æ–≤
- [ ] –î–æ–º–µ–Ω –∫—É–ø–ª–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω
- [ ] SSH –∫–ª—é—á–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã

**–ü–æ—Å–ª–µ setup.sh:**
- [ ] –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
- [ ] .env —Ñ–∞–π–ª –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] PostgreSQL —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Backend —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 3000
- [ ] –ë–æ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç

**–î–æ–º–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
- [ ] DNS –∑–∞–ø–∏—Å–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω
- [ ] https:// —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç —Å http –Ω–∞ https —Ä–∞–±–æ—Ç–∞–µ—Ç

**GitHub Actions:**
- [ ] Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] Workflow —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ

---

## –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs -f`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: `docker-compose restart`
4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ: `docker-compose up -d --build`

---

**–ì–æ—Ç–æ–≤–æ! –í–∞—à –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω! üéâ**

–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –≤—ã –¥–µ–ª–∞–µ—Ç–µ `git push`, –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!
